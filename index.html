<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday!</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS for utility classes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* Custom Styles & Animations */
        body {
            margin: 0;
            padding: 0;
            background-color: #0f0f1a; /* Dark background */
            color: white;
            font-family: 'Nunito', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #app {
            width: 100%;
            max-width: 450px; /* Mobile-like container */
            height: 100%;
            position: relative;
            background: radial-gradient(circle at center, #1a1a2e 0%, #0f0f1a 100%);
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* Background Floating Hearts */
        .bg-hearts {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
        .heart {
            position: absolute;
            font-size: 1.5rem;
            color: rgba(255, 105, 180, 0.1);
            animation: floatUp linear infinite;
        }
        @keyframes floatUp {
            0% { transform: translateY(100vh) scale(0.5); opacity: 0; }
            50% { opacity: 0.5; }
            100% { transform: translateY(-10vh) scale(1); opacity: 0; }
        }

        /* Scene Transitions */
        .scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease-in-out;
            z-index: 1;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
        }
        .scene.active {
            opacity: 1;
            pointer-events: all;
            z-index: 10;
        }

        /* Typography */
        h1, h2 {
            font-family: 'Fredoka One', cursive;
            text-shadow: 0 0 10px rgba(255, 105, 180, 0.5);
        }
        .neon-text {
            color: #ff69b4;
            text-shadow: 0 0 5px #ff69b4, 0 0 10px #ff69b4;
        }

        /* Buttons */
        .btn-primary {
            background: linear-gradient(45deg, #ff69b4, #ff1493);
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            color: white;
            font-family: 'Fredoka One', cursive;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 20, 147, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .btn-primary:active {
            transform: scale(0.95);
        }
        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(255, 20, 147, 0.6);
        }

        /* --- Scene 1: Loading --- */
        .loading-number {
            font-size: 6rem;
            font-family: 'Fredoka One', cursive;
            color: #a855f7; /* Purple */
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.6);
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        /* --- Scene 2: Welcome --- */
        .character-img {
            width: 200px;
            height: 200px;
            object-fit: contain;
            animation: bounce 2s infinite;
            margin-bottom: 20px;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* --- Scene 3: Cake --- */
        .cake-container {
            position: relative;
            width: 250px;
            height: 200px;
            margin-top: 50px;
            margin-bottom: 50px;
        }
        .cake-base {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 100px;
            background: #5d4037;
            border-radius: 50%;
            box-shadow: 0 4px 0 #3e2723, 0 8px 0 #3e2723, 0 12px 0 #3e2723;
            z-index: 1;
        }
        .cake-layer {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 90px;
            background: #5d4037;
            border-radius: 50%;
            z-index: 2;
        }
        .cake-icing {
            position: absolute;
            top: 35px; /* Adjusted */
            left: 50%;
            transform: translateX(-50%);
            width: 210px;
            height: 100px;
            background: #fce4ec;
            border-radius: 50%;
            z-index: 3;
        }
        .icing-drip {
            position: absolute;
            top: 50px;
            width: 30px;
            height: 40px;
            background: #fce4ec;
            border-radius: 0 0 20px 20px;
            z-index: 3;
        }
        .candle {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 50px;
            background: linear-gradient(#ff0000, #b30000);
            z-index: 4;
            border-radius: 4px;
            display: none; /* Hidden initially */
        }
        .flame {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 20px;
            background: orange;
            border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 10px orange, 0 0 20px yellow;
            animation: flicker 0.5s infinite;
            display: none;
        }
        @keyframes flicker {
            0% { transform: translateX(-50%) scale(1); opacity: 1; }
            50% { transform: translateX(-50%) scale(1.1); opacity: 0.8; }
            100% { transform: translateX(-50%) scale(1); opacity: 1; }
        }

        /* Decorations (Banners) */
        .decorations {
            position: absolute;
            top: -100px; /* Hidden initially */
            left: 0;
            width: 100%;
            transition: top 0.5s ease;
            z-index: 0;
        }
        .decorations.show {
            top: 20px;
        }
        .banner-line {
            display: flex;
            justify-content: space-around;
            width: 100%;
        }
        .flag {
            width: 0; 
            height: 0; 
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid;
        }

        /* --- Scene 4: Balloons --- */
        .balloon-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            height: 300px;
            align-items: flex-end;
            margin-bottom: 30px;
        }
        .balloon-wrapper {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .balloon-wrapper:hover {
            transform: translateY(-10px);
        }
        .balloon {
            width: 60px;
            height: 75px;
            border-radius: 50%;
            position: relative;
        }
        .balloon::before {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 10px solid currentColor;
        }
        .string {
            position: absolute;
            top: 75px;
            left: 50%;
            width: 1px;
            height: 100px;
            background: rgba(255,255,255,0.5);
            transform-origin: top;
        }
        .pop-msg {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: bold;
            font-size: 1.2rem;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
            white-space: nowrap;
        }

        /* --- Scene 5: Photos --- */
        .photo-stack {
            position: relative;
            width: 280px;
            height: 350px;
            margin-bottom: 30px;
        }
        .photo-card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            padding: 10px;
            padding-bottom: 40px; /* For polaroid look */
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border-radius: 5px;
            transition: transform 0.5s, opacity 0.5s;
            cursor: grab;
            display: flex;
            justify-content: center;
            align-items: center;
            transform-origin: bottom center;
        }
        .photo-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 3px;
            pointer-events: none;
        }

        /* --- Scene 6: Letter --- */
        .envelope-container {
            perspective: 1000px;
            width: 300px;
            height: 400px;
            cursor: pointer;
        }
        .card {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 1s;
            position: relative;
        }
        .card.open {
            transform: rotateY(-180deg); /* Open like a book */
            /* Note: We will actually rotate the cover, not the whole card wrapper usually, 
               but for a simple flip effect to reveal inside: */
        }
        /* Let's do a book style card */
        .card-front {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            background: linear-gradient(135deg, #9c27b0, #673ab7);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2;
            transform-origin: left;
            transition: transform 0.8s;
        }
        .card-inside {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #fff0f5; /* Lavender blush */
            color: #4a4a4a;
            border-radius: 10px;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: left;
            z-index: 1;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            line-height: 1.5;
            transform: rotateY(0deg); /* Is visible underneath */
        }
        .card-open-anim .card-front {
            transform: rotateY(-135deg);
        }

        /* --- Scene 7: Gift --- */
        .gift-box-container {
            position: relative;
            width: 150px;
            height: 150px;
            cursor: pointer;
            margin-bottom: 30px;
        }
        .gift-box {
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom right, #ff5252, #d32f2f);
            position: relative;
            animation: shake 2s infinite;
        }
        .gift-lid {
            position: absolute;
            top: -20px;
            left: -10px;
            width: 170px;
            height: 40px;
            background: #ff1744;
            z-index: 2;
            transition: transform 0.5s;
        }
        .gift-ribbon-vertical {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 100%;
            background: white;
        }
        .gift-ribbon-horizontal {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            height: 30px;
            background: white;
        }
        .cat-popup {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(100%); /* Hidden initially */
            width: 120px;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1;
        }
        .gift-open .gift-lid {
            transform: translateY(-100px) rotate(-10deg);
        }
        .gift-open .gift-box {
            animation: none;
        }
        .gift-open .cat-popup {
            transform: translateX(-50%) translateY(-80px);
        }
        
        @keyframes shake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(3deg); }
            75% { transform: rotate(-3deg); }
        }

    </style>
</head>
<body>

    <!-- Audio -->
    <audio id="bgMusic" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mp3">
        <!-- Using a placeholder song. User can replace. -->
    </audio>

    <div id="app">
        <!-- Background Hearts -->
        <div class="bg-hearts" id="heartsContainer"></div>

        <!-- SCENE 1: Loading -->
        <div id="scene1" class="scene active">
            <div class="loading-number" id="loadingCounter">0</div>
            <p class="mt-4 text-pink-300 text-lg">Crafting your special moment...</p>
        </div>

        <!-- SCENE 2: Welcome -->
        <div id="scene2" class="scene">
            <!-- Cute SVG Character Placeholder -->
            <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbDd3Y3J3Y3J3Y3J3/26FLdmIp6wJr91JAI/giphy.gif" alt="Cute Bear" class="character-img rounded-full bg-white bg-opacity-10 p-2">
            <h1 class="text-2xl mb-2 text-pink-400">A Cutiepie was born today,</h1>
            <h2 class="text-3xl mb-6 text-purple-300">23 years ago!</h2>
            <p class="mb-8 text-gray-300">Yes, it's YOU! A little surprise awaits...</p>
            <button class="btn-primary" onclick="goToScene(3)">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="8" width="18" height="4" rx="1"></rect><path d="M12 8v13"></path><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"></path><path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"></path></svg>
                Start the surprise
            </button>
        </div>

        <!-- SCENE 3: Cake -->
        <div id="scene3" class="scene">
            <!-- Decor Banners -->
            <div class="decorations" id="decorations">
                <div class="banner-line">
                    <div class="flag" style="color: #ff4081;"></div>
                    <div class="flag" style="color: #7c4dff;"></div>
                    <div class="flag" style="color: #00bcd4;"></div>
                    <div class="flag" style="color: #ffeb3b;"></div>
                    <div class="flag" style="color: #ff4081;"></div>
                </div>
            </div>

            <div class="cake-container">
                <div class="cake-icing"></div>
                <div class="icing-drip" style="left: 20px;"></div>
                <div class="icing-drip" style="left: 60px; height: 30px;"></div>
                <div class="icing-drip" style="left: 100px;"></div>
                <div class="icing-drip" style="left: 150px; height: 25px;"></div>
                <div class="cake-layer"></div>
                <div class="cake-base"></div>
                <div class="candle" id="candle">
                    <div class="flame" id="flame"></div>
                </div>
            </div>

            <h2 id="cakeTitle" class="text-2xl mb-8 opacity-0 transition-opacity duration-500">Happy Birthday, Shemdi!</h2>

            <button id="cakeBtn" class="btn-primary" onclick="handleCakeStep()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2.69l5.74 5.88-5.74 5.88-5.74-5.88z"></path><path d="M11 21.31h2"></path><path d="M12 21.31V8.57"></path></svg>
                Decorate
            </button>
        </div>

        <!-- SCENE 4: Balloons -->
        <div id="scene4" class="scene">
            <h2 class="text-2xl mb-8">Pop all 4 balloons</h2>
            
            <div class="balloon-container">
                <div class="balloon-wrapper" onclick="popBalloon(this, 'You', 0)">
                    <div class="pop-msg" style="color: #ff4081;">You</div>
                    <div class="balloon" style="background: #ff4081; color: #ff4081;"></div>
                    <div class="string"></div>
                </div>
                <div class="balloon-wrapper" onclick="popBalloon(this, 'are', 1)">
                    <div class="pop-msg" style="color: #ffd700;">are</div>
                    <div class="balloon" style="background: #ffd700; color: #ffd700;"></div>
                    <div class="string"></div>
                </div>
                <div class="balloon-wrapper" onclick="popBalloon(this, 'a', 2)">
                    <div class="pop-msg" style="color: #00e676;">a</div>
                    <div class="balloon" style="background: #00e676; color: #00e676;"></div>
                    <div class="string"></div>
                </div>
                <div class="balloon-wrapper" onclick="popBalloon(this, 'Cutie', 3)">
                    <div class="pop-msg" style="color: #2979ff;">Cutie</div>
                    <div class="balloon" style="background: #2979ff; color: #2979ff;"></div>
                    <div class="string"></div>
                </div>
            </div>

            <div class="h-16"> <!-- Spacer for button -->
                <button id="balloonsNextBtn" class="btn-primary hidden opacity-0 transition-opacity" onclick="goToScene(5)">
                    Next
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"></path><path d="M12 5l7 7-7 7"></path></svg>
                </button>
            </div>
        </div>

        <!-- SCENE 5: Photos -->
        <div id="scene5" class="scene">
            <h2 class="text-2xl mb-2">Some Sweet Moments</h2>
            <p class="text-sm text-gray-400 mb-4">(Tap the cards)</p>

            <div class="photo-stack" id="photoStack">
                <!-- Photos injected via JS -->
            </div>

            <button id="photoNextBtn" class="btn-primary hidden" onclick="goToScene(6)">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><path d="M22 6l-10 7L2 6"></path></svg>
                Open My Message
            </button>
        </div>

        <!-- SCENE 6: Card -->
        <div id="scene6" class="scene">
            <h2 class="text-2xl mb-8">A Special Message</h2>
            
            <div class="envelope-container" onclick="openCard()">
                <div class="card" id="letterCard">
                    <!-- Front -->
                    <div class="card-front p-4 border-4 border-purple-400">
                        <div class="text-4xl mb-4">üéÇ</div>
                        <h1 class="text-3xl font-bold text-white mb-2">Happy</h1>
                        <h1 class="text-4xl font-bold text-yellow-300 mb-2">BIRTHDAY</h1>
                        <h2 class="text-xl text-white">Vanshita</h2>
                        <div class="mt-8 px-4 py-2 bg-white text-purple-600 rounded-full text-sm font-bold animate-pulse">Tap to Open</div>
                    </div>
                    <!-- Inside -->
                    <div class="card-inside bg-pink-50 shadow-inner">
                        <p class="font-bold text-purple-600 text-lg mb-2">Guess what day it is!</p>
                        <p class="text-sm text-gray-700 mb-2">The day the world got its future CA Vanshita Sanghi.</p>
                        <p class="text-sm text-gray-700 mb-2">In this auspicious day of yours I would love to express the gratitude of praiseworthy qualities that make u a rare species more than a stereotype.</p>
                        <p class="text-sm text-gray-700">The more exuberant year awaits u and to celebrate your birthday I wish u a "queen's crown and scepter".</p>
                        <p class="text-sm text-gray-700">May all the joy that u have spread come around back to you and heaven pours all showers of blessing upon your life.</p>
                        <div class="mt-4 text-right text-purple-600 font-cursive text-xl">- Piyush</div>
                    </div>
                </div>
            </div>

            <button id="cardNextBtn" class="btn-primary opacity-0 mt-8 pointer-events-none transition-opacity" onclick="goToScene(7)">
                Next
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"></path><path d="M12 5l7 7-7 7"></path></svg>
            </button>
        </div>

        <!-- SCENE 7: Gift -->
        <div id="scene7" class="scene">
            <h2 class="text-2xl mb-8">One Last Thing...</h2>
            
            <div class="gift-box-container" id="giftContainer" onclick="openGift()">
                <div class="cat-popup">
                    <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbDd3Y3J3Y3J3Y3J3/26FLdmIp6wJr91JAI/giphy.gif" alt="Surprise Cat" class="w-full">
                </div>
                <div class="gift-lid">
                    <div class="gift-ribbon-vertical"></div>
                </div>
                <div class="gift-box">
                    <div class="gift-ribbon-vertical"></div>
                    <div class="gift-ribbon-horizontal"></div>
                </div>
            </div>

            <p id="giftText" class="opacity-0 transition-opacity duration-1000 mb-2 text-pink-300 text-lg font-bold">Tap the gift</p>
            
            <div id="finalMessage" class="opacity-0 transition-opacity duration-1000 text-center hidden">
                <h3 class="text-xl text-white font-bold mb-2">Lots of love for you ‚ù§Ô∏è</h3>
                <p class="text-gray-300 mb-6">Your incredible talent and unwavering dedication are the clear signature of the phenomenal Chartered Accountant you will be.  </p>
                <button class="btn-primary mx-auto" onclick="location.reload()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path></svg>
                    Replay
                </button>
            </div>
        </div>

    </div>

    <script>
        // --- Variables ---
        let currentScene = 1;
        let cakeStep = 0; // 0: Init, 1: Decorated, 2: Lit
        let poppedCount = 0;
        const audio = document.getElementById('bgMusic');

        // --- Helpers ---
        function show(id) { document.getElementById(id).classList.remove('hidden'); }
        function hide(id) { document.getElementById(id).classList.add('hidden'); }
        
        // --- Init Background Hearts ---
        function createHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = '‚ù§';
            heart.classList.add('heart');
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (Math.random() * 3 + 2) + 's';
            document.getElementById('heartsContainer').appendChild(heart);
            setTimeout(() => heart.remove(), 5000);
        }
        setInterval(createHeart, 300);

        // --- Scene Navigation ---
        function goToScene(n) {
            // Try to play audio on first interaction
            if (audio.paused) {
                audio.play().catch(e => console.log("Audio autoplay blocked", e));
            }

            document.querySelector('.scene.active').classList.remove('active');
            document.getElementById('scene' + n).classList.add('active');
            currentScene = n;
        }

        // --- Scene 1: Loading Logic ---
        let count = 0;
        const counterEl = document.getElementById('loadingCounter');
        const loader = setInterval(() => {
            count++;
            counterEl.innerText = count;
            if (count >= 100) {
                clearInterval(loader);
                setTimeout(() => goToScene(2), 500);
            }
        }, 30); // 30ms * 100 = ~3s

        // --- Scene 3: Cake Logic ---
        function handleCakeStep() {
            const btn = document.getElementById('cakeBtn');
            const title = document.getElementById('cakeTitle');
            
            if (cakeStep === 0) {
                // Decorate
                document.getElementById('decorations').classList.add('show');
                btn.innerHTML = `
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"></path><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                    Light the Candle
                `;
                cakeStep = 1;
            } else if (cakeStep === 1) {
                // Light
                document.getElementById('candle').style.display = 'block';
                document.getElementById('flame').style.display = 'block';
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                title.style.opacity = 1;
                btn.innerHTML = `
                     <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg>
                    Pop the Balloons
                `;
                cakeStep = 2;
            } else {
                goToScene(4);
            }
        }

        // --- Scene 4: Balloons Logic ---
        function popBalloon(el, msg, index) {
            if (el.classList.contains('popped')) return;
            
            // Pop Visuals
            el.classList.add('popped');
            el.querySelector('.balloon').style.transform = "scale(0)";
            el.querySelector('.balloon').style.opacity = "0";
            
            // Show Text
            const msgEl = el.querySelector('.pop-msg');
            msgEl.style.opacity = 1;
            msgEl.style.transform = "translateY(-10px) translateX(-50%)";

            // Play pop sound (optional/simulated)
            
            poppedCount++;
            if (poppedCount === 4) {
                const nextBtn = document.getElementById('balloonsNextBtn');
                nextBtn.classList.remove('hidden');
                setTimeout(() => {
                    nextBtn.classList.remove('opacity-0');
                }, 100);
            }
        }

        // --- Scene 5: Photos Logic ---
        const photos = [
            'img1.jpg', // Holding hands / Couple
            'img2.jpg', // Girl portrait
            'img3.jpg', // Cute couple 2
        ];
        const stack = document.getElementById('photoStack');
        
        // Init Photos
        photos.forEach((url, i) => {
            const card = document.createElement('div');
            card.className = 'photo-card';
            card.style.zIndex = photos.length - i;
            card.style.transform = `rotate(${Math.random() * 10 - 5}deg)`;
            card.innerHTML = `<img src="${url}" alt="Moment">`;
            card.onclick = () => removeCard(card);
            stack.appendChild(card);
        });

        function removeCard(card) {
            card.style.transform = "translateY(-100vh) rotate(20deg)";
            card.style.opacity = "0";
            setTimeout(() => card.remove(), 500);
            
            if (stack.children.length <= 1) { // Last one being removed
                // Automatically go to next scene after animation
                setTimeout(() => {
                    goToScene(6);
                }, 500);
            }
        }

        // --- Scene 6: Card Logic ---
        let cardOpen = false;
        function openCard() {
            if (cardOpen) return;
            document.getElementById('letterCard').classList.add('card-open-anim');
            cardOpen = true;
            
            const btn = document.getElementById('cardNextBtn');
            setTimeout(() => {
                btn.classList.remove('opacity-0');
                btn.style.pointerEvents = 'all';
            }, 1000);
        }

        // --- Scene 7: Gift Logic ---
        function openGift() {
            const container = document.getElementById('giftContainer');
            if (container.classList.contains('gift-open')) return;
            
            container.classList.add('gift-open');
            document.getElementById('giftText').style.opacity = 0;
            
            confetti({
                particleCount: 150,
                spread: 100,
                origin: { y: 0.7 }
            });

            setTimeout(() => {
                document.getElementById('finalMessage').classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('finalMessage').classList.remove('opacity-0');
                }, 100);
            }, 1000);
        }

    </script>
</body>
</html>
